(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"02cd":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e._self._c;return t("q-page",{staticClass:"q-pa-sm"},[t("q-header",{class:e.darkMode?"":"bg-grey-1",style:e.darkMode?"background: var(--q-color-dark);":"",attrs:{elevated:""}},[t("q-toolbar",{staticClass:"q-gutter-x-sm",class:e.darkMode?"":"text-black"},[t("q-btn",{attrs:{"no-caps":"",flat:"",dense:"",icon:"arrow_back",label:e.$t("Return to Properties"),to:"/Pipelines/"+this.pipelineUid+"/Properties"}}),t("q-separator",{attrs:{vertical:""}}),t("q-toolbar-title",{staticClass:"text-center",staticStyle:{opacity:".4"}},[e._v(e._s(e.$tc("Edit Deployment | Edit Deployment: {pipelineName} | Edit Deployment: {pipelineName}",e.pipeline&&e.pipeline.name&&e.pipeline.name.length?1:0,{pipelineName:e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name:""})))])],1)],1),t("div",{staticClass:"q-gutter-y-sm"},[t("q-card",[t("q-card-section",{staticClass:"col q-ma-none q-pa-none"},[t("q-card-section",{staticClass:"text-h4"},[e._v("\n            "+e._s(e.$t("Select a Suitable OpenCollector"))+"\n        ")]),t("q-card-section",[t("q-table",{attrs:{data:e.tableData,columns:e.columns,"row-key":"uid",dense:"","no-data-label":e.$t("No OpenCollector to display."),filter:e.searchFilter,loading:e.dataLoading||e.collectorLogSourcesLoading,"rows-per-page-label":e.$t("OpenCollectors per page:"),pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[t("div",{staticClass:"full-width row wrap justify-between"},[t("div",{staticClass:"q-table__title"},[e._v("\n                  "+e._s(e.$t("Available OpenCollectors"))+"\n                ")]),t("div",{staticClass:"row q-gutter-md"},[t("div",{staticStyle:{width:"300px"}},[t("q-input",{attrs:{outlined:"",dense:"",debounce:"300",placeholder:e.$t("Search")},scopedSlots:e._u([{key:"append",fn:function(){return[e.searchFilter.length?t("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:function(t){e.searchFilter=""}}}):e._e(),t("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.searchFilter,callback:function(t){e.searchFilter=t},expression:"searchFilter"}})],1),t("q-btn",{attrs:{dense:"",outline:"",icon:"refresh",loading:e.dataLoading},on:{click:function(t){return e.loadOpenCollectorsPipelinesAndLogSources()}}},[t("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                      "+e._s(e.$t("Reload the list of Pipelines."))+"\n                    ")])],1)],1)])]},proxy:!0},{key:"body-cell-actions",fn:function(o){return[t("q-td",{attrs:{props:o}},[!o.row.deploymentStatus||!0!==o.row.deploymentStatus.ongoing&&!0!==o.row.deploymentStatus.completed?t("q-btn",{attrs:{flat:"",dense:"",icon:"add_circle_outline",disable:!o.row.suitable||!0===o.row.alreadyDeployed},on:{click:function(t){return e.selectOpenCollectorForDeployment(o.row)}}},[t("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[e._v("\n                    "+e._s(e.$t("Deploy"))+"\n                  ")])],1):t("q-btn",{attrs:{flat:"",dense:""}},[t("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[t("div",[t("div",{staticClass:"row justify-between q-my-sm q-mr-sm"},[t("div",{staticClass:"row items-center q-gutter-x-sm"},[t("q-icon",{attrs:{name:"list",color:"blue-3",size:"md"}}),t("div",{staticClass:"text-h6"},[e._v("Deployment Steps")])],1),t("div",{staticClass:"q-gutter-x-md"},[o.row&&o.row.deploymentStatus&&!0===o.row.deploymentStatus.error?t("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}):o.row&&o.row.deploymentStatus&&!0===o.row.deploymentStatus.completed?t("q-icon",{attrs:{name:"task_alt",color:"positive",size:"md"}}):e._e(),t("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(o.row,"deploymentStatus").done),"show-value":"","font-size":e.deploymentProgressFor(o.row,"deploymentStatus").done<100?"0.5em":"0.4em",size:"2.8em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":o.row&&o.row.deploymentStatus&&!0===o.row.deploymentStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":o.row&&o.row.deploymentStatus&&!0===o.row.deploymentStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1)]),t("q-separator"),t("div",{staticClass:"q-mb-sm"},e._l(o.row&&o.row.deploymentStatus&&o.row.deploymentStatus.steps&&o.row.deploymentStatus.steps.length?o.row.deploymentStatus.steps:[],(function(o,s){return t("q-item",{key:s,staticStyle:{"min-width":"30rem"},attrs:{dense:""}},[t("q-item-section",[t("q-item-label",[t("div",{staticClass:"row items-center no-wrap"},[t("q-icon",{class:"On-going"===o.status||"Error"===o.status?"":"invisible",attrs:{name:"arrow_right",size:"sm"}}),t("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",class:"On-going"===o.status||"Error"===o.status?"text-bold":""},[e._v(e._s(o.name))])],1)])],1),t("q-item-section",{attrs:{side:""}},["Not started"===o.status?t("q-icon",{attrs:{name:"hourglass_empty",size:"sm",color:"grey"}}):"To skip"===o.status?t("q-icon",{attrs:{name:"redo",size:"sm",color:"grey"}}):"Pending"===o.status?t("q-icon",{attrs:{name:"hourglass_top",size:"sm",color:"grey-3"}}):"On-going"===o.status?t("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):"Completed"===o.status?t("q-icon",{attrs:{name:"task_alt",size:"sm",color:"positive"}}):"Skipped"===o.status?t("q-icon",{staticStyle:{opacity:".5"},attrs:{name:"redo",size:"sm",color:"green-4"}}):"Error"===o.status?t("q-icon",{attrs:{name:"error",size:"sm",color:"orange"}}):"Cancelled"===o.status?t("q-icon",{attrs:{name:"block",size:"sm",color:"grey"}}):e._e()],1)],1)})),1),o.row&&e.deploymentProgressFor(o.row,"deploymentStatus").errorAbsolute?t("div",[t("q-separator"),t("div",{staticClass:"row items-center col no-wrap"},[t("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}),t("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),t("q-separator",{staticClass:"q-ml-none q-mr-sm",attrs:{vertical:"",color:"negative",size:"0.2rem"}}),t("div",{staticClass:"q-my-sm"},[o.row.deploymentStatus.errorMessage&&o.row.deploymentStatus.errorMessage.length?t("div",{staticClass:"text-bold text-orange"},[e._v(e._s(e.$t("The last step failed with this error message:")))]):t("div",{staticClass:"text-bold"},[e._v(e._s(e.$t("The last step failed with no error message.")))]),t("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",staticStyle:{"max-width":"35rem"}},[e._v(e._s(o.row.deploymentStatus.errorMessage))])])],1)],1):e._e(),o.row&&e.deploymentProgressFor(o.row,"deploymentStatus").skippedAbsolute?t("div",[t("q-separator"),t("div",{staticClass:"row items-center col no-wrap"},[t("q-icon",{attrs:{name:"redo",color:"green-4",size:"md"}}),t("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),t("div",{staticClass:"q-my-sm"},[t("div",{staticClass:"text-bold"},[e._v(e._s(e.$tc("| One step has been skipped. | {count} steps have been skipped.",Math.round(e.deploymentProgressFor(o.row,"deploymentStatus").skippedAbsolute))))]),t("div",{},[e._v(e._s(e.$t("This is fine. Steps are typically skipped if not necessary for a given deployment.")))])])],1)],1):e._e()],1)]),t("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(o.row,"deploymentStatus").done),"show-value":"","font-size":e.deploymentProgressFor(o.row,"deploymentStatus").done<100?"0.5em":"0.4em",size:"1.7em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":o.row&&o.row.deploymentStatus&&!0===o.row.deploymentStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":o.row&&o.row.deploymentStatus&&!0===o.row.deploymentStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1),!o.row.unDeployStatus||!0!==o.row.unDeployStatus.ongoing&&!0!==o.row.unDeployStatus.completed?t("q-btn",{attrs:{flat:"",dense:"",icon:"remove_circle_outline",color:"negative",disable:!(!0===o.row.alreadyDeployed)},on:{click:function(t){return e.selectOpenCollectorForUndeploy(o.row)}}},[t("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[t("div",{staticClass:"text-bold q-mb-sm"},[e._v(e._s(e.$t("Un-deploy")))]),t("div",{staticClass:"q-mb-xs"},[e._v(e._s(e.$t("This Stream has already been deployed on this OpenCollector.")))]),t("div",[e._v(e._s(e.$t("This will remove the configuration from the Shipper on the OpenCollector, but will leave the OpenCollector's Pipeline and SIEM Log Source as they are.")))])])],1):t("q-btn",{attrs:{flat:"",dense:""}},[t("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[t("div",[t("div",{staticClass:"row justify-between q-my-sm q-mr-sm"},[t("div",{staticClass:"row items-center q-gutter-x-sm"},[t("q-icon",{attrs:{name:"list",color:"blue-3",size:"md"}}),t("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("Un-Deployment Steps")))])],1),t("div",{staticClass:"q-gutter-x-md"},[o.row&&o.row.unDeployStatus&&!0===o.row.unDeployStatus.error?t("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}):o.row&&o.row.unDeployStatus&&!0===o.row.unDeployStatus.completed?t("q-icon",{attrs:{name:"task_alt",color:"positive",size:"md"}}):e._e(),t("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(o.row,"unDeployStatus").done),"show-value":"","font-size":e.deploymentProgressFor(o.row,"unDeployStatus").done<100?"0.5em":"0.4em",size:"2.8em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":o.row&&o.row.unDeployStatus&&!0===o.row.unDeployStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":o.row&&o.row.unDeployStatus&&!0===o.row.unDeployStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1)]),t("q-separator"),t("div",{staticClass:"q-mb-sm"},e._l(o.row&&o.row.unDeployStatus&&o.row.unDeployStatus.steps&&o.row.unDeployStatus.steps.length?o.row.unDeployStatus.steps:[],(function(o,s){return t("q-item",{key:s,staticStyle:{"min-width":"30rem"},attrs:{dense:""}},[t("q-item-section",[t("q-item-label",[t("div",{staticClass:"row items-center no-wrap"},[t("q-icon",{class:"On-going"===o.status||"Error"===o.status?"":"invisible",attrs:{name:"arrow_right",size:"sm"}}),t("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",class:"On-going"===o.status||"Error"===o.status?"text-bold":""},[e._v(e._s(o.name))])],1)])],1),t("q-item-section",{attrs:{side:""}},["Not started"===o.status?t("q-icon",{attrs:{name:"hourglass_empty",size:"sm",color:"grey"}}):"To skip"===o.status?t("q-icon",{attrs:{name:"redo",size:"sm",color:"grey"}}):"Pending"===o.status?t("q-icon",{attrs:{name:"hourglass_top",size:"sm",color:"grey-3"}}):"On-going"===o.status?t("q-spinner-dots",{attrs:{color:"blue-10",size:"2em"}}):"Completed"===o.status?t("q-icon",{attrs:{name:"task_alt",size:"sm",color:"positive"}}):"Skipped"===o.status?t("q-icon",{staticStyle:{opacity:".5"},attrs:{name:"redo",size:"sm",color:"green-4"}}):"Error"===o.status?t("q-icon",{attrs:{name:"error",size:"sm",color:"orange"}}):"Cancelled"===o.status?t("q-icon",{attrs:{name:"block",size:"sm",color:"grey"}}):e._e()],1)],1)})),1),o.row&&e.deploymentProgressFor(o.row,"unDeployStatus").errorAbsolute?t("div",[t("q-separator"),t("div",{staticClass:"row items-center col no-wrap"},[t("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}),t("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),t("q-separator",{staticClass:"q-ml-none q-mr-sm",attrs:{vertical:"",color:"negative",size:"0.2rem"}}),t("div",{staticClass:"q-my-sm"},[o.row.unDeployStatus.errorMessage&&o.row.unDeployStatus.errorMessage.length?t("div",{staticClass:"text-bold text-orange"},[e._v(e._s(e.$t("The last step failed with this error message:")))]):t("div",{staticClass:"text-bold"},[e._v(e._s(e.$t("The last step failed with no error message.")))]),t("div",{staticClass:"force-long-text-wrap ellipsis-3-lines",staticStyle:{"max-width":"35rem"}},[e._v(e._s(o.row.unDeployStatus.errorMessage))])])],1)],1):e._e(),o.row&&e.deploymentProgressFor(o.row,"unDeployStatus").skippedAbsolute?t("div",[t("q-separator"),t("div",{staticClass:"row items-center col no-wrap"},[t("q-icon",{attrs:{name:"redo",color:"green-4",size:"md"}}),t("q-separator",{staticClass:"q-mx-sm",attrs:{vertical:""}}),t("div",{staticClass:"q-my-sm"},[t("div",{staticClass:"text-bold"},[e._v(e._s(e.$tc("| One step has been skipped. | {count} steps have been skipped.",Math.round(e.deploymentProgressFor(o.row,"unDeployStatus").skippedAbsolute)))+" ")]),t("div",{},[e._v(e._s(e.$t("This is fine. Steps are typically skipped if not necessary for a given deployment.")))])])],1)],1):e._e()],1)]),t("q-circular-progress",{attrs:{value:Math.round(e.deploymentProgressFor(o.row,"unDeployStatus").done),"show-value":"","font-size":e.deploymentProgressFor(o.row,"unDeployStatus").done<100?"0.5em":"0.4em",size:"1.7em",thickness:.2,color:e.darkMode?"blue-3":"blue-10","track-color":o.row&&o.row.unDeployStatus&&!0===o.row.unDeployStatus.error?e.darkMode?"red-10":"red":e.darkMode?"grey-9":"grey-3","center-color":o.row&&o.row.unDeployStatus&&!0===o.row.unDeployStatus.error?e.darkMode?"orange-10":"orange":void 0}})],1)],1)]}},{key:"body-cell-status",fn:function(o){return[t("q-td",{attrs:{props:o}},[!0===o.value?t("q-icon",{attrs:{name:"thumb_up",color:"green",size:"md"}}):!1===o.value?t("q-icon",{staticStyle:{opacity:".6"},attrs:{name:"thumb_down",color:"red",size:"md"}}):t("q-icon",{staticStyle:{opacity:".6"},attrs:{name:"thumb_down_off_alt",color:"orange",size:"md"}}),t("q-tooltip",{attrs:{"content-style":"font-size: 1em"}},[!0===o.value?t("span",[e._v(e._s(e.$t("Suitable")))]):!1===o.value?t("span",[e._v(e._s(e.$t("Unsuitable")))]):t("span",[e._v(e._s(e.$t("Unknown. Likely unsuitable ({propValue})",{propValue:o.value})))])])],1)]}},{key:"body-cell-installedShippers",fn:function(o){return[t("q-td",{attrs:{props:o}},[e._l(o.value,(function(o,s){return t("div",{key:s},[t("q-tooltip",{attrs:{"content-style":"font-size: 1em;"}},[e._v(e._s(o.name))]),t("q-avatar",{staticClass:"q-mr-xs",attrs:{square:"",size:"24px"}},[t("img",{attrs:{src:"/shippers/"+e.collectionShipperDetails(o.name).icon+".svg"}})]),t("q-badge",{attrs:{outline:"",color:"grey"}},[e._v("v"+e._s(o.version))])],1)})),!0!==o.row.hasNecessaryShipper?t("div",[t("q-tooltip",{attrs:{"content-style":"font-size: 1em;"}},[e._v("\n                    "+e._s(e.$t("The necessary Shipper to collect this source is not installed on this collector."))),t("br"),t("br"),e._v("\n                    "+e._s(e.$t("Please go to the Collectors page to deploy this Shipper on this Collector."))),t("br"),t("br"),t("q-icon",{staticClass:"q-mr-sm",attrs:{name:"info",size:"sm",color:"info"}}),t("span",{staticClass:"text-bold"},[e._v(e._s(e.$t("Missing:")))]),t("br"),t("div",{staticClass:"q-ml-lg q-mt-sm row"},[t("div",{staticClass:"text-center"},[t("span",{},[e._v(e._s(e.pipeline&&e.pipeline.collectionConfig&&e.pipeline.collectionConfig.collectionShipper?e.pipeline.collectionConfig.collectionShipper:"N/A"))]),t("br"),t("img",{staticClass:"q-mt-sm",attrs:{src:"/shippers/"+e.collectionShipperDetails(e.pipeline&&e.pipeline.collectionConfig&&e.pipeline.collectionConfig.collectionShipper?e.pipeline.collectionConfig.collectionShipper:null).icon+".svg",width:"128px"}})])])],1),t("q-badge",{staticClass:"q-gutter-x-sm",attrs:{outline:"",color:"orange"}},[t("q-icon",{attrs:{name:"warning",size:"sm",color:"orange"}}),t("div",{staticClass:"icon-stack"},[t("img",{staticClass:"img-stack-75",attrs:{src:"/shippers/"+e.collectionShipperDetails(e.pipeline&&e.pipeline.collectionConfig&&e.pipeline.collectionConfig.collectionShipper?e.pipeline.collectionConfig.collectionShipper:null).icon+".svg"}}),t("img",{staticClass:"img-stack-100 img-stack-opacity-50",attrs:{src:"/shippers/_block_overlay.svg"}})])],1)],1):e._e()],2)]}}])})],1)],1)],1)],1),t("hr")],1)},i=[],a=(o("caad"),o("5319"),o("2f62")),r=o("31c4"),l=o("c1dc"),n=o("a87d"),p=o("16f1"),c={mixins:[r["a"],l["a"],n["a"],p["a"]],data(){return{pipelineUid:"",openCollectorUid:"",searchFilter:"",columns:[{name:"actions",align:"center",label:this.$t("Actions"),field:"actions",sortable:!1},{name:"status",align:"center",label:this.$t("Suitable"),field:"suitable",sortable:!0},{name:"openCollector",align:"center",label:this.$t("OpenCollector"),field:"openCollectorHost",sortable:!0},{name:"installedShippers",align:"center",label:this.$t("Installed Shippers"),field:e=>e.openCollector?e.openCollector.installedShippers:void 0,sortable:!0},{name:"name",align:"center",label:this.$t("Log Source Name"),field:"name",sortable:!0},{name:"msgSourceId",align:"center",label:this.$t("Log Source ID"),field:"msgSourceId",sortable:!0},{name:"hostName",align:"center",label:this.$t("Log Source Host"),field:"hostName",sortable:!0},{name:"hostId",align:"center",label:this.$t("Log Source Host ID"),field:"hostId",sortable:!0}],pagination:{sortBy:"status",descending:!0,rowsPerPage:25},collectorLogSourcesLoading:!1,deploymentStatuses:[],unDeployStatuses:[],deploymentStepsNewLogSource:[{uid:"e745e0e6-60f6-4857-8afa-f8ea0663b6c3",name:this.$t("Create and drop Beat's configuration in right location"),status:"Not started",apiEndpoint:"/oc/UpdateStreamConfigurationForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"d004f165-a028-4183-8e6d-f64534357c5d",name:this.$t("Import JQ Pipeline into OpenCollector"),status:"Not started",apiEndpoint:"/oc/ImportPipelineForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"b632b998-cd67-4571-a384-31faf0053d1a",name:this.$t("Create Log Source Type"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceType",apiParamNames:["uid","name"]},{uid:"7e739d98-d427-4fac-9f63-392e8ccb4c94",name:this.$t("Create MPE Rule"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateMpeRule",apiParamNames:["uid","name"]},{uid:"04ff4e8c-de73-419a-a48b-944b01bca836",name:this.$t("Create MPE Sub-Rule(s)"),status:"To skip",apiEndpoint:"/logrhythmCore/UpdateMpeSubRule",apiParamNames:["uid","SubRuleUid","SubRuleName","Tag1"],specialTag:["runForEachSubRule"]},{uid:"6fba3b49-580b-4ceb-b8be-374fc848fe63",name:this.$t("Create Processing Policy"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateProcessingPolicy",apiParamNames:["uid","name","MPEPolicy_Name"]},{uid:"dd1fae83-10af-40ea-bfe9-20ff668d5141",name:this.$t("Create Log Source (LS) Virtualisation"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceVirtualisationTemplate",apiParamNames:[]},{uid:"857787cd-4ec5-4c06-b044-7aaf37de326f",name:this.$t("Create new LS Virtualisation Item and associate it to LS Virtualisation"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceVirtualisationTemplateItem",apiParamNames:["uid","name"]},{uid:"5c0a3a9c-6d01-40e6-acb8-b0763a52bba3",name:this.$t("Add LS Virtualisation to OpenCollector Log Source"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateOpenCollectorLogSourceWithLogSourceVirtualisation",apiParamNames:["uid","OpenCollectorMotherLogSourceID"]}],deploymentStepsExistingLogSource:[{uid:"d1038519-da8b-4580-91a6-8c34b3001327",name:this.$t("Update Beat configuration"),status:"Not started",apiEndpoint:"/oc/UpdateStreamConfigurationForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"b0f41342-c758-4453-8381-9be346f25dfe",name:this.$t("Re-import JQ Pipeline into OpenCollector"),status:"Not started",apiEndpoint:"/oc/ImportPipelineForBeat",apiParamNames:["openCollector","beat","stream"]},{uid:"3d0ef0a5-0c65-4b62-a68a-e1422490ffef",name:this.$t("Modify MPE Sub-Rule(s)"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateMpeSubRule",apiParamNames:["uid","SubRuleUid","SubRuleName","Tag1","Tag2","Tag3","Tag4","Tag5"]},{uid:"32d0bf3c-9e09-4388-9a68-cec7c8b38529",name:this.$t("Modify Processing Policy"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateProcessingPolicy",apiParamNames:["uid","name","MPEPolicy_Name"]},{uid:"72e265cd-9d0d-469c-b1fd-8a319f3971b2",name:this.$t("Modify Log Source Virtualisation"),status:"Not started",apiEndpoint:"/logrhythmCore/UpdateLogSourceVirtualisationTemplateItem",apiParamNames:["uid","name"]}],unDeploySteps:[{uid:"8276950b-c01b-423e-8ce0-1ed23af6efe4",name:this.$t("Delete Beat configuration for Stream"),status:"Not started",apiEndpoint:"/oc/DeleteStreamConfigurationForBeat",apiParamNames:["openCollector","beat","stream"]}]}},computed:{...Object(a["d"])("mainStore",["openCollectorBeats","loggedInUser","collectionShippersOptions"]),...Object(a["c"])("mainStore",["openCollectorLogSources"]),pipeline(){const e=this.pipelines.find((e=>e.uid===this.pipelineUid));return e||{uid:"",name:"",status:"New",primaryOpenCollector:"",fieldsMapping:[],collectionConfig:{}}},deployments(){const e=[];return this.openCollectors.forEach((t=>{t.pipelines&&Array.isArray(t.pipelines)&&t.pipelines.forEach((o=>{o.uid===this.pipelineUid&&e.push({pipelineUid:o.uid,openCollector:t,enabled:o.enabled})}))})),e},tableData(){const e=[];this.openCollectorLogSources.forEach((t=>{let o=!1;this.openCollectors.forEach((s=>{if(t.hostIdentifiers&&Array.isArray(t.hostIdentifiers)&&s.hostname){const i=String(s.hostname).toLowerCase(),a=t.hostIdentifiers.filter((e=>e.value&&String(e.value).toLowerCase()===i));if(a.length){o=!0;const i=t.hostIdentifiers.reduce(((e,t)=>(t.value&&t.value.length&&e.push(t.value),e)),[]),a=this.hasNecessaryShipper(s);e.push({openCollector:s,openCollectorLogSource:t,pipelineUid:this.pipeline.uid,suitable:!!(o&a),openCollectorHost:s&&s.name&&s.hostname?s.name+" ("+s.hostname+")":null,name:t.name,msgSourceId:t.msgSourceID,hostName:t.hostName+" ("+i.join(" / ")+")",hostId:t.hostID,hasNecessaryShipper:a,deploymentStatus:this.deploymentStatuses.find((e=>e&&e.openCollectorUid&&s&&s.uid&&t&&t.msgSourceID&&e.msgSourceId===t.msgSourceID&&e.openCollectorUid===s.uid)),unDeployStatus:this.unDeployStatuses.find((e=>e&&e.openCollectorUid&&s&&s.uid&&t&&t.msgSourceID&&e.msgSourceId===t.msgSourceID&&e.openCollectorUid===s.uid)),alreadyDeployed:this.isAlreadyDeployed(s,this.pipeline.uid)})}}})),o||e.push({openCollector:null,openCollectorLogSource:t,pipelineUid:this.pipeline.uid,suitable:o,openCollectorHost:null,name:t.name,msgSourceId:t.msgSourceID,hostName:t.hostName,hostId:t.hostID,hasNecessaryShipper:!1})}));const t=e.reduce(((e,t)=>(t&&t.openCollector&&t.openCollector.uid&&t.openCollector.uid.length&&e.push(t.openCollector.uid),e)),[]);return this.openCollectors.forEach((o=>{t.includes(o.uid)||e.push({openCollector:o,openCollectorLogSource:null,pipelineUid:this.pipeline.uid,openCollectorHost:o&&o.name&&o.hostname?o.name+" ("+o.hostname+")":null,suitable:!1,hasNecessaryShipper:this.hasNecessaryShipper(o),alreadyDeployed:this.isAlreadyDeployed(o,this.pipeline.uid)})})),e},beatName(){return this.pipeline&&this.pipeline.collectionConfig&&this.pipeline.collectionConfig.collectionShipper?this.pipeline.collectionConfig.collectionShipper:""},beatConfigForStream(){const e=this.collectionShippersOptions.find((e=>e.value&&e.value===this.beatName));return this.pipeline&&this.pipeline.collectionConfig&&this.pipeline.collectionConfig.collectionShipper&&e?this.collectionConfigOutputFor(e.outputFormat,this.pipeline.collectionConfig):""}},methods:{...Object(a["b"])("mainStore",["getOpenCollectorLogSources","callDeploymentStepApi","upsertOpenCollector"]),loadOpenCollectorLogSources(){this.getOpenCollectorLogSources({loadingVariableName:"collectorLogSourcesLoading",caller:this})},loadOpenCollectorsPipelinesAndLogSources(){this.loadOpenCollectorsAndPipelines(),this.loadOpenCollectorLogSources()},selectOpenCollectorForDeployment(e){const t=!0;this.kickOffDeployment(e,this.deploymentStepsNewLogSource,this.deploymentStatuses,t)},selectOpenCollectorForUndeploy(e){const t=!1;this.kickOffDeployment(e,this.unDeploySteps,this.unDeployStatuses,t)},kickOffDeployment(e,t,o,s){if(e&&e.openCollector&&e.openCollector.uid&&e.openCollector.uid.length&&e.msgSourceId){const i=o.find((t=>t.openCollectorUid===e.openCollector.uid&&t.msgSourceId===e.msgSourceId));i?(i.ongoing=!0,i.completed=!1,i.isDeployment=s,o=JSON.parse(JSON.stringify(o))):o.push({openCollectorUid:e.openCollector.uid,msgSourceId:e.msgSourceId,ongoing:!0,completed:!1,isDeployment:s,logs:[],steps:JSON.parse(JSON.stringify(t))}),setTimeout(this.runDeploymentStep,500,this,o,e,0)}},deploymentProgressFor(e,t){const o=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.length:1,s=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.filter((e=>e.status&&e.status.length&&"completed"===e.status.toLowerCase())).length:0,i=s/o*100,a=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.filter((e=>e.status&&e.status.length&&"skipped"===e.status.toLowerCase())).length:0,r=a/o*100,l=e&&e[t]&&e[t].steps&&e[t].steps.length?e[t].steps.filter((e=>e.status&&e.status.length&&"error"===e.status.toLowerCase())).length:0,n=l/o*100;return{done:i+r,completed:i,skipped:r,error:n,completedAbsolute:s,skippedAbsolute:a,errorAbsolute:l}},hasNecessaryShipper(e){const t=this.pipeline&&this.pipeline.collectionConfig&&this.pipeline.collectionConfig.collectionShipper&&this.pipeline.collectionConfig.collectionShipper.length?this.pipeline.collectionConfig.collectionShipper.toLowerCase():null;return!!((e&&e.installedShippers&&Array.isArray(e.installedShippers)&&e.installedShippers.filter((e=>e.name&&e.name.toLowerCase()===t)).length)|this.openCollectorBeats.filter((e=>e.value&&e.value.toLowerCase()===t)).length)},runDeploymentStep(e,t,o,s){if(o&&o.openCollector&&o.openCollector.uid&&o.openCollector.uid.length&&o.msgSourceId){const i=t.find((e=>e.openCollectorUid===o.openCollector.uid&&e.msgSourceId===o.msgSourceId));if(i&&i.steps&&i.steps.length>s){const a=i.steps[s];let r=!1;if(r|=a.status&&"To skip"===a.status,r)a.status="Skipped",setTimeout(e.runDeploymentStep,150,e,t,o,s+1);else{a.status="On-going";const r=a.apiEndpoint&&a.apiEndpoint.length?a.apiEndpoint:"/test/doesNotExist/andShouldReturnAnError",l={uid:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length?e.pipeline.uid:void 0,name:e&&e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name:void 0,MPEPolicy_Name:"LogRhythm Default",OpenCollectorMotherLogSourceID:i.msgSourceId,openCollector:{uid:i.openCollectorUid&&i.openCollectorUid.length?i.openCollectorUid:void 0},beat:{name:e.beatName,config:[this.beatConfigForStream]},stream:{uid:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length?e.pipeline.uid:void 0,name:e&&e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name:void 0,sanitisedName:e&&e.pipeline&&e.pipeline.name&&e.pipeline.name.length?e.pipeline.name.replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase():void 0,jqFilter:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length&&e.pipeline.name&&e.pipeline.name.length&&e.beatName&&e.beatName.length&&e.loggedInUser&&e.loggedInUser.length?this.buildJqFilterFromParams(e.pipeline.uid,e.pipeline.name,e.beatName,e.loggedInUser):void 0,jqTransform:e&&e.pipeline&&e.pipeline.uid&&e.pipeline.uid.length&&e.pipeline.name&&e.pipeline.name.length&&e.beatName&&e.beatName.length&&e.loggedInUser&&e.loggedInUser.length?this.buildJqTransformFromParams(e.pipeline.uid,e.pipeline.name,e.beatName,e.loggedInUser,e.pipeline.options&&!0===e.pipeline.options.extractMessageFieldOnly,e.pipeline.fieldsMapping||[]):void 0}},n=a.apiParamNames&&a.apiParamNames.length?a.apiParamNames.reduce(((e,t)=>(e[t]=l&&l[t]?l[t]:void 0,e)),{}):void 0;e.callDeploymentStepApi({apiUrl:r,caller:e,apiCallParams:n,dataLabel:`Step name: ${a.name}`,onSuccessCallBack:(i,r=a,l=o,n=s,p=e,c=t)=>{setTimeout((()=>{r.status="Completed",p.runDeploymentStep(p,c,l,n+1)}),100+Math.floor(600*Math.random()))},onErrorCallBack:(e,t=a,o=i)=>{t.status="Error",o.ongoing=!1,o.completed=!0,o.error=!0,o.errorMessage=e&&e.messageForLogAndPopup?e.messageForLogAndPopup:"",o.errorMessage+=e&&e.captionForLogAndPopup?` // ${e.captionForLogAndPopup}`:"",o&&o.steps&&Array.isArray(o.steps)&&o.steps.filter((e=>e.status&&("not started"===e.status.toLowerCase()||"to skip"===e.status.toLowerCase()))).forEach((e=>{e.status="Cancelled"}))},debug:!1})}}else i.ongoing=!1,i.completed=!0,console.log("ðŸ We have run out of Steps. Job done."),!0===i.completed&&!0!==i.error&&(console.log("ðŸ’¾ Saving Deployment."),setTimeout((()=>{e.updateAndPersistDeployment(o,i.isDeployment)}),100+Math.floor(250*Math.random())))}},updateAndPersistDeployment(e,t=!0){if(e&&e.openCollector&&e.openCollector.uid&&e.openCollector.uid.length&&e.pipelineUid&&e.pipelineUid.length){const o=JSON.parse(JSON.stringify(this.openCollectors.find((t=>t.uid===e.openCollector.uid))));if(o&&o.uid&&o.uid.length){o.pipelines||(o.pipelines=[]);let s=!1;o.pipelines.filter((t=>t.uid===e.pipelineUid)).forEach((e=>{e.enabled=t,s=!0})),s||o.pipelines.push({enabled:t,uid:e.pipelineUid}),this.upsertOpenCollector({openCollector:o,pushToApi:!0,caller:this})}}},isAlreadyDeployed(e,t){return!!(e&&e.pipelines&&Array.isArray(e.pipelines)&&t&&t.length)&&!!(e.pipelines.filter((e=>!0===e.enabled&&e.uid===t)).length>0)}},mounted(){0===this.openCollectorLogSources.length&&this.loadOpenCollectorLogSources(),this.$route.params.pipelineUid&&this.$route.params.pipelineUid.length&&this.pipelineUid!==this.$route.params.pipelineUid&&(this.pipelineUid=this.$route.params.pipelineUid),this.$route.params.openCollectorUid&&this.$route.params.openCollectorUid.length&&this.openCollectorUid!==this.$route.params.openCollectorUid&&(this.openCollectorUid=this.$route.params.openCollectorUid)}},d=c,u=(o("7c6b"),o("2877")),m=o("9989"),g=o("e359"),h=o("b498"),y=o("65c6"),S=o("9c40"),C=o("eb85"),f=o("6ac5"),b=o("f09f"),w=o("a370"),v=o("eaac"),q=o("27f9"),_=o("0016"),k=o("05c0"),D=o("db86"),N=o("58ea"),P=o("66e5"),L=o("4074"),U=o("0170"),$=o("8380"),M=o("cb32"),I=o("58a8"),O=o("eebe"),z=o.n(O),x=Object(u["a"])(d,s,i,!1,null,"50590c14",null);t["default"]=x.exports;z()(x,"components",{QPage:m["a"],QHeader:g["a"],QColor:h["a"],QToolbar:y["a"],QBtn:S["a"],QSeparator:C["a"],QToolbarTitle:f["a"],QCard:b["a"],QCardSection:w["a"],QTable:v["a"],QInput:q["a"],QIcon:_["a"],QTooltip:k["a"],QTd:D["a"],QCircularProgress:N["a"],QItem:P["a"],QItemSection:L["a"],QItemLabel:U["a"],QSpinnerDots:$["a"],QAvatar:M["a"],QBadge:I["a"]})},"7c6b":function(e,t,o){"use strict";o("cd8f")},cd8f:function(e,t,o){}}]);